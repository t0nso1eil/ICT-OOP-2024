# ICT-OOP-2024

## Команда  12 

**Тема:** Платформа для онлайн-консультаций с психологом (название - Все дело в папе)

| Состав команды |
|:-----|
| Кадникова Екатерина Михайловна |
| Гуторова Инна Владимировна |
| Бахарева Мария Александровна |
| Могильный Михаил Игоревич |
| Полухин Александр Владимирович |

---

## Сущности и связи

### ERD-диаграмма

![final](https://github.com/t0nso1eil/ICT-OOP-2024/assets/112972915/415412c8-e46e-4b80-9cb4-0eff0f6635c2)


### Связи:

`psychologist` 1:M  `chat` 

`psychologist` 1:M  `review` 

`psychologist` 1:M  `message` 

`psychologist` 1:M  `spot`


`client` 1:M `chat`

`client` 1:M  `review`

`client` 1:M  `message` 

`client` 1:M  `session`

`client` 1:M  `payment`


`session` 1:1 `spot`

`payment` 1:1 `session`

`message` M:1 `chat`

### Описание сущностей

#### Клиент
Поля:
1) `client_id` - идентификатор (Guid/varchar) | генерируется, уникальный
2) `first_name` - имя (string/varchar)
3) `last_name` - фамилия (string/varchar)
4) `email` - электронная почта (string/varchar) | уникальна
5) `phone_number` - номер телефона (string/varchar)
6) `password` - пароль (string/varchar)
7) `birthday` - дата рождения (DateOnly/date)
8) `age` - возраст (uint/integer) | вычисляется на основе даты рождения
9) `sex` - пол (string/varchar) | значение выбирается из {"женщина", "мужчина"}
10) `additional_info` - дополнительная информация (string/text)
11) `registration_date` - дата и время регистрации (DateTime/timestamp) | создается автоматически при регистрации

#### Психолог:
Поля:
1) `psychologist_id` - идентификатор (Guid/varchar) | генерируется, уникальный
2) `first_name` - имя (string/varchar)
3) `last_name` - фамилия (string/varchar)
4) `email` - электронная почта (string/varchar) | уникальна
5) `password` - пароль (string/varchar)
6) `birthday` - дата рождения (DateOnly/date)
7) `age` - возраст (uint/integer) | вычисляется на основе даты рождения
8) `sex` - пол (string/varchar) | значение выбирается из {"женщина", "мужчина"}
9) `specialization` - основные подходы в психотерапии, которыми пользуется специалист (string/varchar) | пример: КПТ, гештальт-терапия, психоанализ и тд
10) `experience_start_date` - дата начала практики (DateOnly/date)
11) `experience_years` - стаж работы (uint/integer) | вычисляется на основе даты начала практики
12) `additional_info` - дополнительная информация (string/text)
13) `price_per_hour` - стоимость одной сессии (decimal/numeric)
14) `rate` - средняя оценка психолога (decimal/numeric) | высчитывается как среднее из оценкок в отзывах
15) `registration_date` - дата и время регистрации (DateTime/timestamp) | создается автоматически при регистрации

#### Отзыв:
Поля:
1) `review_id` - идентификатор отзыва (Guid/varchar) | генерируется, уникальный
2) `client_id` - идентификатор клиента, который оставил отзыв (Guid/varchar)
3) `psychologist_id` - идентификатор психолога, на которого оставили отзыв (Guid/varchar)
4) `rate` - оценка (uint/integer) | от 0 до 5
5) `description` - текстовый отзыв (string/text)
6) `post_time` - дата и время публикации отзыва (DateTime/timestamp) | создается автоматически при публикации

#### Сессия:
Поля: 
1) `session_id` - идентификатор отзыва (Guid/varchar) | генерируется, уникальный
2) `client_id` - идентификатор клиента, который записался на сессию (Guid/varchar)
3) `spot_id` - идентификатор окошка, в которое записались (Guid/varchar)
4) `status` - статус (string/varchar) | значение выбирается из {"на согласовании", "ожидает оплаты", "назначена", "отменена", "проведена"}
5) `price` - стоимость сессии (decimal/numeric) | берется из стоимости, прописанной у психолога

Комментарии:
1) Про статус сессии:
* сессия создается как заявка со статусом "на согласовании"
* психолог подтверждает: статус "ожидает оплаты"
* если оплата прошла условно в течение суток-двух, то статус "назначена", иначе - "отменена", освобождается окошко
* в случае неотмены после проведения статус обновляется на "проведена"
2) _На подумать_: удалять отмененную запись запись из бд условно через неделю

#### Окошко:
Поля:
1) `spot_id` - идентификатор окошка (Guid/varchar) | генерируется, уникальный
2) `psychologist_id` - идентификатор психолога (Guid/varchar)
3) `date` - дата (DateOnly/date)
4) `hour_start` - время начала (DateTime/time)
5) `hour_end` - время окончания (DateTime/time)
6) `status` - статус (string/varchar) | значение выбирается из { "доступно", "занято" }

Комментарии:
1) психолог добавляет в свое "расписание" доступные для записи окошки, которые могут видеть клиенты
2) клиент записывается в окошко, создается сессия (_см. [Сессия](README.md:72)_)

#### Сообщение:
Поля:
1) `message_id` - идентификатор окошка (Guid/varchar) | генерируется, уникальный
2) `chat_id` - идентификатор чата (Guid/varchar)
2) `client_id` - идентификатор клиента (Guid/varchar)
3) `psychologist_id` - идентификатор психолога (Guid/varchar)
4) `message_text` - содержание сообщения (string/text)
5) `sent_time` - дата и время отправки (DateTime/timestamp) | создается автоматически при отправке

Комментарии:
1) из двух идентификаторов один всегда null, а другой - нет (в зависимости от того, кто отправляет сообщение)


#### Чат:
Поля:
1) `chat_id` - идентификатор чата (Guid/varchar) | генерируется, уникальный
2) `client_id` - идентификатор клиента (Guid/varchar)
3) `psychologist_id` - идентификатор психолога (Guid/varchar)

---

## Методы работы приложения

Методы работы приложения описаны в папке [ApplicationFunctions](ApplicationFunctions)


